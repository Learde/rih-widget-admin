import{_ as h,o as l,c as v,a as p,f as $,D as j,E as L,t as V,h as g,u as e,B as b,s as S,n as H,F as f,k,p as B,e as D,G as J,w as c,d as y,b as i,r as M,H as Y,J as Q,i as W,g as X,K as Z,l as ee,L as te,y as ae,z as oe,M as re,q as N,N as ne,O as se,j as le}from"./index-pjyOXBHH.js";import{I as ie}from"./IconCategory-iNQC8eK2.js";import{I as O,B as P}from"./BaseSelectMenu-Ha-srSHH.js";import{I as ce}from"./IconPrice-JNlYMlm-.js";import{B as de}from"./BaseBadge-xMYKH756.js";import{B as ue}from"./BaseButton-SXuxPXX_.js";import{u as me,r as E,B as x,a as pe,b as ve}from"./BaseInput-nVZfDFq2.js";import{B as C}from"./BaseFormGroup-Kj1VUKRp.js";const ye={name:"TablerPhoto"},fe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},ge=p("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[p("path",{d:"M15 8h.01M3 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6z"}),p("path",{d:"m3 16l5-5c.928-.893 2.072-.893 3 0l5 5"}),p("path",{d:"m14 14l1-1c.928-.893 2.072-.893 3 0l3 3"})],-1),he=[ge];function $e(t,r,n,a,d,u){return l(),v("svg",fe,he)}const _e=h(ye,[["render",$e]]),Ie=t=>(B("data-v-259de1d7"),t=t(),D(),t),Ve=Ie(()=>p("hr",{class:"category-delim"},null,-1)),ke={__name:"SelectCategoryItem",props:{category:{type:Object,required:!0},hasBorder:{type:Boolean,default:!0},level:{type:Number,default:0},activeId:{type:[Number,String],default:null},isParentActive:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["click"],setup(t){const r=t,n=$(()=>j.isArray(r.category.children)&&r.category.children.length>0),a=$(()=>r.isParentActive||r.activeId===r.category.id),d=$(()=>`${r.level*30}px`);return(u,s)=>{const o=L("SelectCategoryItem",!0);return l(),v(f,null,[p("div",{class:S(["category-item",{loading:t.isLoading}]),style:H({marginLeft:d.value}),onClick:s[0]||(s[0]=m=>u.$emit("click",t.category))},[p("h3",null,V(t.category.title),1),a.value?(l(),g(e(O),{key:0,class:"icon-check"})):b("",!0)],6),Ve,n.value?(l(!0),v(f,{key:0},k(t.category.children,m=>(l(),g(o,{key:m.id,category:m,level:t.level+1,"active-id":t.activeId,"is-parent-active":a.value,onClick:s[1]||(s[1]=_=>u.$emit("click",_))},null,8,["category","level","active-id","is-parent-active"]))),128)):b("",!0)],64)}}},A=h(ke,[["__scopeId","data-v-259de1d7"]]),Se=t=>(B("data-v-95c18537"),t=t(),D(),t),be={class:"select-category-content"},Be={key:1,class:"no-categories"},De=Se(()=>p("span",{class:"no-categories-text"}," Нет добавленных категорий ",-1)),Ce={__name:"SelectCategory",props:{isError:{type:Boolean,default:!1},modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(t){const r=J(),n=function(){r.hasUnloadedOptions&&r.fetchMany({perPage:999,page:1,search:""})};return(a,d)=>{const u=L("RouterLink");return l(),g(e(P),{"modal-title":"Категория инвентаря","is-error":t.isError,onOpen:n},{label:c(()=>[y(" Категория ")]),"modal-content":c(()=>[p("div",be,[!e(r).isManyLoading&&e(r).listData.length>0?(l(!0),v(f,{key:0},k(e(r).listData,(s,o)=>{var m;return l(),g(A,{key:s.id,category:s,"has-border":o!==e(r).listData.length-1,"active-id":(m=t.modelValue)==null?void 0:m.id,onClick:d[0]||(d[0]=_=>a.$emit("update:modelValue",_))},null,8,["category","has-border","active-id"])}),128)):!e(r).isManyLoading&&e(r).listData.length===0?(l(),v("div",Be,[i(e(ie),{class:"no-categories-icon"}),De,i(u,{class:"add-category",to:{name:"AddCategory",query:{backRouteName:"AddInventory"}}},{default:c(()=>[y(" Добавить категорию ")]),_:1})])):(l(),v(f,{key:2},k(8,s=>i(A,{key:s,category:{},"has-border":s!==8,"is-loading":""},null,8,["has-border"])),64))])]),"error-text":c(()=>[M(a.$slots,"error-text",{},void 0,!0)]),_:3},8,["is-error"])}}},we=h(Ce,[["__scopeId","data-v-95c18537"]]),Ne=t=>(B("data-v-9b48fbdf"),t=t(),D(),t),Ee=Ne(()=>p("hr",{class:"inventory-price-delim"},null,-1)),xe={__name:"SelectInventoryPriceItem",props:{inventoryPrice:{type:Object,required:!0},hasBorder:{type:Boolean,default:!0},level:{type:Number,default:0},isActive:{type:Boolean,defulat:!1},isLoading:{type:Boolean,default:!1}},emits:["click"],setup(t){return(r,n)=>(l(),v(f,null,[p("div",{class:S(["inventory-price-item",{loading:t.isLoading}]),onClick:n[0]||(n[0]=a=>r.$emit("click",t.inventoryPrice))},[p("h3",null,V(t.inventoryPrice.title),1),t.isActive?(l(),g(e(O),{key:0,class:"icon-check"})):b("",!0)],2),Ee],64))}},R=h(xe,[["__scopeId","data-v-9b48fbdf"]]),Le=t=>(B("data-v-878674f8"),t=t(),D(),t),Me={class:"select-inventory-price-content"},Oe={key:1,class:"no-inventory-prices"},Pe=Le(()=>p("span",{class:"no-inventory-prices-text"}," Нет добавленных тарифов ",-1)),Te={__name:"SelectInventoryPrice",props:{isError:{type:Boolean,default:!1},modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(t){const r=Y(),n=function(){r.hasUnloadedOptions&&r.fetchMany({perPage:999,page:1,search:""})};return(a,d)=>{const u=L("RouterLink");return l(),g(e(P),{"modal-title":"Тарифы","is-error":t.isError,onOpen:n},{label:c(()=>[y(" Тариф * ")]),"modal-content":c(()=>[p("div",Me,[!e(r).isManyLoading&&e(r).listData.length>0?(l(!0),v(f,{key:0},k(e(r).listData,(s,o)=>{var m;return l(),g(R,{key:s.id,"inventory-price":s,"has-border":o!==e(r).listData.length-1,"is-active":s.id===((m=t.modelValue)==null?void 0:m.id),onClick:d[0]||(d[0]=_=>a.$emit("update:modelValue",_))},null,8,["inventory-price","has-border","is-active"])}),128)):!e(r).isManyLoading&&e(r).listData.length===0?(l(),v("div",Oe,[i(e(ce),{class:"no-inventory-prices-icon"}),Pe,i(u,{class:"add-inventory-price",to:{name:"AddInventoryPrice",query:{backRouteName:"AddInventory"}}},{default:c(()=>[y(" Добавить тариф ")]),_:1})])):(l(),v(f,{key:2},k(8,s=>i(R,{key:s,"inventory-price":{},"has-border":s!==8,"is-loading":""},null,8,["has-border"])),64))])]),"error-text":c(()=>[M(a.$slots,"error-text",{},void 0,!0)]),_:3},8,["is-error"])}}},Ae=h(Te,[["__scopeId","data-v-878674f8"]]),Re={key:0,class:"select-state-delim"},Ue={__name:"SelectInventoryStateItem",props:{state:{type:Object,required:!0},description:{type:String,default:""},hasBorder:{type:Boolean,default:!0},isActive:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},setup(t){return(r,n)=>(l(),v(f,null,[p("div",{class:"select-state-badge-wrapper",onClick:n[0]||(n[0]=a=>r.$emit("click"))},[i(e(de),{class:S(["select-state-badge",{loading:t.isLoading}]),color:t.state.color,size:"md","padding-x":"8px"},{default:c(()=>[y(V(t.state.title),1)]),_:1},8,["class","color"])]),p("div",{class:S(["select-state-description-wrapper",{mr:t.isActive}]),onClick:n[1]||(n[1]=a=>r.$emit("click"))},[p("span",{class:S(["select-state-description",{loading:t.isLoading}])},V(t.description),3),t.isActive?(l(),g(e(O),{key:0,class:"select-state-check"})):b("",!0)],2),t.hasBorder?(l(),v("hr",Re)):b("",!0)],64))}},U=h(Ue,[["__scopeId","data-v-dd5330e8"]]),F={FREE:"Инвентарь доступен для аренды",BROKEN:"Инвентарь недоступен для аренды",RENT:"Инвентарь сейчас находится в аренде",BOOKED:"На инвентарь имеются аренды в будущем времени",default:"Пользовательский статус инвентаря"},Fe={class:"select-state-content"},je={__name:"SelectInventoryState",props:{isError:{type:Boolean,default:!1},modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(t){const r=Q(),n=function(){r.hasUnloadedOptions&&r.fetchMany({perPage:999,page:1,search:""})};return(a,d)=>(l(),g(e(P),{"modal-title":"Статус инвентаря","is-error":t.isError,onOpen:n},{label:c(()=>[y(" Статус * ")]),"modal-content":c(()=>[p("div",Fe,[e(r).isManyLoading?(l(),v(f,{key:1},k(4,u=>i(U,{key:u,state:{},"has-border":u!==4,"is-loading":""},null,8,["has-border"])),64)):(l(!0),v(f,{key:0},k(e(r).listData,(u,s)=>{var o;return l(),g(U,{key:u.id,state:u,description:e(F)[u.stateConst]??e(F).default,"has-border":s!==e(r).listData.length-1,"is-active":u.id===((o=t.modelValue)==null?void 0:o.id),onClick:m=>a.$emit("update:modelValue",u)},null,8,["state","description","has-border","is-active","onClick"])}),128))])]),"error-text":c(()=>[M(a.$slots,"error-text",{},void 0,!0)]),_:3},8,["is-error"]))}},qe=h(je,[["__scopeId","data-v-f995448b"]]),ze=t=>(B("data-v-39b7091f"),t=t(),D(),t),Ke={class:"image-select"},Ge=ze(()=>p("label",{class:"label"},"Добавить изображение",-1)),He={__name:"BaseImageSelect",setup(t){return(r,n)=>(l(),v("div",Ke,[i(e(_e),{class:"icon"}),Ge]))}},Je=h(He,[["__scopeId","data-v-39b7091f"]]),Ye={class:"wrapper"},Qe=["placeholder"],We={__name:"BaseTextarea",props:{placeholder:{type:String,default:""},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(t,{emit:r}){const d=W(t,"modelValue",r);return(u,s)=>(l(),v("div",Ye,[X(p("textarea",{class:"input",placeholder:t.placeholder,"onUpdate:modelValue":s[0]||(s[0]=o=>ee(d)?d.value=o:null)},null,8,Qe),[[Z,e(d)]])]))}},Xe=h(We,[["__scopeId","data-v-ee21efb9"]]),Ze={title:"",article:"",inventoryNumber:"",description:"",state:null,category:null,price:null},et=te("inventoryForm",()=>{const t=ae(),r=oe();let n=re(j.clone(Ze));const a=N("pending"),d=N(null),u=N(!1),o=me({formData:{title:{required:E},state:{required:E},price:{required:E}}},{formData:n}),m=$(()=>!o.value.formData.title.$error),_=$(()=>!o.value.formData.price.$error),q=$(()=>!o.value.formData.state.$error),z=$(()=>o.value.formData.title.$errors),K=$(()=>o.value.formData.price.$errors),G=$(()=>o.value.formData.state.$errors),T=function(){n.title="",n.article="",n.inventoryNumber="",n.description="",n.state=null,n.category=null,n.price=null,a.value="pending",d.value=null,o.value.$reset()};return{save:async function(){if(!await o.value.$validate()){u.value=!0;return}a.value="loading",d.value?await t.editOne(d.value,{id:d.value,...n}):await t.addOne(n),a.value="success",setTimeout(()=>{a.value="pending",T(),r.push({name:"Inventories"})},1500)},handleTitleInput:function(){o.value.formData.title.$touch()},formData:n,state:a,isNotificationShown:u,v$:o,isTitleValid:m,isPriceValid:_,isStateValid:q,titleErrors:z,priceErrors:K,stateErrors:G,fillFormData:async function(w){a.value="loading";const I=await t.getOne(w);n.title=I.title,n.article=I.article,n.inventoryNumber=I.inventoryNumber,n.description=I.description,n.state=I.state,n.category=I.category,n.price=I.price,d.value=w,a.value="pending"},$reset:T}}),tt={class:"wrapper"},at={__name:"InventoryAddPage",props:{id:{type:[String,Number],default:null}},setup(t){const r=t,n=ne(),a=et(),d=se();return le(()=>{d.query.noReset||(a.$reset(),r.id&&a.fillFormData(r.id))}),(u,s)=>(l(),v(f,null,[p("div",tt,[i(e(C),{"is-error":!e(a).isTitleValid},{label:c(()=>[y(" Название инвентаря * ")]),content:c(()=>[i(e(x),{placeholder:"Введите название","is-error":!e(a).isTitleValid,modelValue:e(a).formData.title,"onUpdate:modelValue":s[0]||(s[0]=o=>e(a).formData.title=o),onInput:e(a).handleTitleInput},null,8,["is-error","modelValue","onInput"])]),"error-text":c(()=>{var o,m;return[y(V(e(n).validationMessages[(m=(o=e(a).titleErrors)==null?void 0:o.at(0))==null?void 0:m.$validator]),1)]}),_:1},8,["is-error"]),i(e(C),null,{label:c(()=>[y(" Артикул ")]),content:c(()=>[i(e(x),{placeholder:"Введите артикул",modelValue:e(a).formData.article,"onUpdate:modelValue":s[1]||(s[1]=o=>e(a).formData.article=o)},null,8,["modelValue"])]),_:1}),i(e(C),null,{label:c(()=>[y(" Инвентарный номер ")]),content:c(()=>[i(e(x),{placeholder:"Введите номер",modelValue:e(a).formData.inventoryNumber,"onUpdate:modelValue":s[2]||(s[2]=o=>e(a).formData.inventoryNumber=o)},null,8,["modelValue"])]),_:1}),i(e(C),null,{label:c(()=>[y(" Описание ")]),content:c(()=>[i(e(Xe),{placeholder:"Введите описание",modelValue:e(a).formData.description,"onUpdate:modelValue":s[3]||(s[3]=o=>e(a).formData.description=o)},null,8,["modelValue"])]),_:1}),i(e(qe),{modelValue:e(a).formData.state,"onUpdate:modelValue":s[4]||(s[4]=o=>e(a).formData.state=o),"is-error":!e(a).isStateValid},{"error-text":c(()=>{var o,m;return[y(V(e(n).validationMessages[(m=(o=e(a).stateErrors)==null?void 0:o.at(0))==null?void 0:m.$validator]),1)]}),_:1},8,["modelValue","is-error"]),i(e(we),{modelValue:e(a).formData.category,"onUpdate:modelValue":s[5]||(s[5]=o=>e(a).formData.category=o)},null,8,["modelValue"]),i(e(Ae),{modelValue:e(a).formData.price,"onUpdate:modelValue":s[6]||(s[6]=o=>e(a).formData.price=o),"is-error":!e(a).isPriceValid},{"error-text":c(()=>{var o,m;return[y(V(e(n).validationMessages[(m=(o=e(a).priceErrors)==null?void 0:o.at(0))==null?void 0:m.$validator]),1)]}),_:1},8,["modelValue","is-error"]),i(e(Je)),i(e(ue),{onClick:e(a).save},{default:c(()=>[y("Сохранить")]),_:1},8,["onClick"])]),i(e(pe),{state:e(a).state},null,8,["state"]),i(e(ve),{modelValue:e(a).isNotificationShown,"onUpdate:modelValue":s[7]||(s[7]=o=>e(a).isNotificationShown=o),type:"error"},null,8,["modelValue"])],64))}},vt=h(at,[["__scopeId","data-v-9cd8e780"]]);export{vt as default};
