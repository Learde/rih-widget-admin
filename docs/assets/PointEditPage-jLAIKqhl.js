import{u as E,B as S,a as $,b as x,r as L}from"./BaseInput-XmIfhhwm.js";import{Q as T,a1 as b,L as P,z as h,N as F,q as f,f as V,j as I,a0 as M,o as O,c as _,a as k,b as i,w as c,u as o,F as q,d as g,t as R}from"./index-C6X_CLJF.js";import{B as U}from"./BaseFormGroup-Pt3KonYi.js";const Q={__name:"PointEditPage",props:{id:{type:[String,Number],default:null}},setup(B){const a=B,w=T(),m=b(),n=P(),y=h(),e=F({title:""}),u=f(!1),r=E({formData:{title:{required:L}}},{formData:e}),p=V(()=>!r.value.formData.title.$error),N=V(()=>r.value.formData.title.$errors),D=function(){r.value.formData.title.$touch()},s=f("pending");return I(async()=>{if(a.id){s.value="loading";const d=await n.getOne(a.id);s.value="pending",e.title=d.title}m.addEventListener("ready",async()=>{if(!await r.value.$validate()){u.value=!0;return}s.value="loading",a.id?await n.editOne(a.id,{id:a.id,title:e.title}):await n.addOne({title:e.title}),s.value="success",setTimeout(()=>{y.push({name:"Points"})},1500)})}),M(()=>{m.clearEventListeners("ready")}),(d,l)=>(O(),_(q,null,[k("div",null,[i(o(U),{"is-error":!p.value},{label:c(()=>[g(" Название пункта проката * ")]),content:c(()=>[i(o(S),{placeholder:"Введите название","is-error":!p.value,modelValue:e.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.title=t),onInput:D},null,8,["is-error","modelValue"])]),"error-text":c(()=>{var t,v;return[g(R(o(w).validationMessages[(v=(t=N.value)==null?void 0:t.at(0))==null?void 0:v.$validator]),1)]}),_:1},8,["is-error"])]),i(o($),{state:s.value},null,8,["state"]),i(o(x),{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=t=>u.value=t),type:"error"},null,8,["modelValue"])],64))}};export{Q as default};
