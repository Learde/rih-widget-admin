import{_ as nt,o as k,c as T,a as G,r as Ke,b as W,w as L,i as P,F as ue,j as Me,t as ie,Y as ve,A as U,k as N,P as he,Z as Re,q as rt,$ as Te,e as Ue,n as we,f as ee,x as at,E as Ve,u as H,a0 as lt,a1 as de,a2 as it,L as gt,g as pt,a3 as vt,R as mt,p as yt,d as bt}from"./index-436tC9rP.js";import{I as Dt}from"./IconCategory-p8R_rgdG.js";import{I as St}from"./IconDelete-DwjwV3ks.js";import{I as Ct}from"./IconEdit-B9fWQRWJ.js";import{B as wt}from"./BaseButton-lhhRx-Nn.js";import{B as je}from"./BaseDeleteModal-xrcPYuyQ.js";const _t={name:"MaterialSymbolsLightMenuRounded"},Et={width:"20",height:"10",viewBox:"0 0 20 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ot=G("path",{d:"M19.25 8C19.6642 8 20 8.33579 20 8.75C20 9.16421 19.6642 9.5 19.25 9.5H0.75C0.335786 9.5 0 9.16421 0 8.75C0 8.33579 0.335786 8 0.75 8H19.25ZM19.25 4C19.6642 4 20 4.33579 20 4.75C20 5.16421 19.6642 5.5 19.25 5.5H0.75C0.335786 5.5 0 5.16421 0 4.75C0 4.33579 0.335786 4 0.75 4H19.25ZM19.25 0C19.6642 0 20 0.335786 20 0.75C20 1.16421 19.6642 1.5 19.25 1.5H0.75C0.335786 1.5 0 1.16421 0 0.75C0 0.335786 0.335786 0 0.75 0H19.25Z",fill:"#99A2AD"},null,-1),kt=[Ot];function xt(e,t,n,a,u,r){return k(),T("svg",Et,kt)}const $t=nt(_t,[["render",xt]]);var Tt=!1,Pt=!0;function pe(e){"@babel/helpers - typeof";return pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(e)}function Lt(e,t){if(pe(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t||"default");if(pe(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nt(e){var t=Lt(e,"string");return pe(t)=="symbol"?t:String(t)}function ge(e,t,n){return t=Nt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}/*!
 * helper-js v3.1.5
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */function _e(e){return Object.prototype.toString.call(e)==="[object Array]"}function We(e){return Object.prototype.toString.call(e)==="[object Object]"}function Bt(e){return typeof e=="function"}function Ft(e,t){return e<t?e:t}function st(e,t){let n,a=0;for(;(n=e.indexOf(t))>-1;)e.splice(n,1),a++;return a}function ot(e){return e[e.length-1]}function It(e){return _e(e)?e:[e]}function At(e,t){let n=new Set(t);const a={};return n.forEach(u=>{a[u]=e[u]}),a}function*Kt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.reverse)if(e.length!=null)for(let n=e.length-1;n>=0;n--){const a={value:e[n],index:n};(!t.exclude||!t.exclude(a))&&(yield a)}else if(We(e)){const n=Object.keys(e);n.reverse();for(const a of n){const u={value:e[a],key:a};(!t.exclude||!t.exclude(u))&&(yield u)}}else throw"Unsupported type";else if(e.length!=null)for(let n=0;n<e.length;n++){const a={value:e[n],index:n};(!t.exclude||!t.exclude(a))&&(yield a)}else if(We(e))for(const n of Object.keys(e)){const a={value:e[n],key:n};(!t.exclude||!t.exclude(a))&&(yield a)}else throw"Unsupported type"}function Mt(e,t,n){e.hasOwnProperty(t)||(e[t]=n)}function dt(e,t){return Object.keys(t).forEach(n=>{Mt(e,n,t[n])}),e}function Rt(e){const t={};return Object.keys(e).forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t}function X(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n=dt({...n},{childrenKey:"children"});const{childrenKey:a}=n,u=_e(e)?e:[e];class r{}const i=(l,c,s)=>{n.reverse&&(l=l.slice(),l.reverse());const o=l.length;for(let f=0;f<o;f++){const d=l[f],h=n.reverse?o-f-1:f,g=s?[...s,h]:[];n.childFirst&&d[a]!=null&&i(d[a],d,g);const y=t(d,h,c,g);if(y===!1)throw new r;if(y==="skip children")continue;if(y==="skip siblings")break;n.childFirst||d[a]!=null&&i(d[a],d,g)}};try{i(u,null,_e(e)?[]:null)}catch(l){if(!(l instanceof r))throw l}}function Vt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a;return X(e,function(){if(t(...arguments))return a={node:arguments.length<=0?void 0:arguments[0],index:arguments.length<=1?void 0:arguments[1],parent:arguments.length<=2?void 0:arguments[2],path:arguments.length<=3?void 0:arguments[3]},!1},n),a}function Ht(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=Vt(e,t,n);return a==null?void 0:a.node}function ut(e,t){const n={childrenKey:"children"};t&&Object.assign(n,t);const{childrenKey:a,nodeHandler:u}=n,r=new He;return r.childrenKey=a,X(e,(i,l,c,s)=>{let o=Object.assign({},i);o[a]&&(o[a]=[]),u&&(o=u(o,{oldNode:i,index:l,parent:c,path:s})),r.set(s,o)},{childrenKey:a}),r.data}class He{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ge(this,"data",void 0),ge(this,"childrenKey","children"),this.data=t}get rootChildren(){const{childrenKey:t}=this,{data:n}=this;return _e(n)?n:n[t]}*iteratePath(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{childrenKey:a,rootChildren:u}=this;if(n.reverse){const r=[...this.iteratePath(t,{...n,reverse:!1})];r.reverse();for(const{path:i,node:l}of r)yield{path:i,node:l}}else{let r=[],i=u;for(const l of t){const c=[...r,l],s=i[l];yield{path:c,node:s},r=c,i=s[a]}}}getFamily(t){const n=[];for(const{node:a}of this.iteratePath(t))n.push(a);return n}get(t){return ot(this.getFamily(t))}getParentAndIndex(t){const n=t.slice(),a=n.pop();return{parent:this.get(n),index:a,parentPath:n}}getParent(t){return this.getParentAndIndex(t).parent}set(t,n){if(t==null||t.length===0)this.data=n;else{const{childrenKey:a}=this;let{rootChildren:u}=this;const{parent:r,index:i}=this.getParentAndIndex(t);let l;t.length===1?(u||(this.data?this.data[a]=[]:this.data=[]),l=u):(r[a]||(r[a]=[]),l=r[a]),l[i]=n}}delete(t){const{childrenKey:n,rootChildren:a}=this,{parent:u,index:r}=this.getParentAndIndex(t),i=t.length===1?a:u[n],l=i[r];return i.splice(r,1),l}walk(t,n){const{childrenKey:a,data:u}=this;return X(u,t,a,n)}clone(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ut(this.data),Rt({childrenKey:this.childrenKey,nodeHandler:t.nodeHandler||void 0})}}function Xe(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Bt(e)?e(...t):e}function zt(e,t){return function(){let a,u;try{a=e(...arguments)}catch(r){u=r}finally{t()}if(u)throw u;return a}}function ce(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[];let a;const u={};let r=u;return{action:function(){for(var c=arguments.length,s=new Array(c),o=0;o<c;o++)s[o]=arguments[o];if(s.length===0)return r===u&&(r=e()),r;if(a||(a=new Xt),!a.has(s)&&(a.set(s,e(...s)),t.capacity!=null)){n.push(s);const f=n.splice(0,n.length-t.capacity);for(const d of f)a.delete(d)}return a.get(s)},clearCache:()=>{a=null,n.splice(0,n.length)}}}function Ut(){let e,t;return{promise:new Promise((a,u)=>{e=a,t=u}),resolve:e,reject:t}}function jt(e,t){for(;;){if(e.parentNode==null)return!1;if(e.parentNode===t)return!0;e=e.parentNode}}function Pe(e){let t=e.getBoundingClientRect();if(document.documentElement.clientTop>0){const n=t.top-document.documentElement.clientTop,a=t.bottom,u=t.left-document.documentElement.clientLeft,r=t.right,i=t.width||r-u,l=t.height||a-n,o={top:n,right:r,bottom:a,left:u,width:i,height:l,x:u,y:n};t={...o,toJSON:()=>o}}return t}function Ye(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n&&n.withSelf?e:e.parentElement;for(;a;){const u=n.until&&a===n.until;if(u&&!n.withUntil)return;const r=t(a);if(r==="break")return;if(r)return a;if(u)return;a=a.parentElement}}function Ee(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function qe(e,t){for(const n of t)if(Ee(e,n))return!0;return!1}function Y(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on".concat(t),n,a)}function q(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent&&e.detachEvent("on".concat(t),n,a)}function Wt(e){let t=[];const n=()=>{if(!u.listening){for(const r of e){Y.apply(this,r);const i=()=>q.apply(this,r);t.push(i)}u.listening=!0}},u={listening:!1,stop:()=>{if(u.listening){for(const r of t)r();t=[],u.listening=!1}},resume:n,start:n};return u.start(),u}function Oe(e,t){return getComputedStyle(e)[t]}function ze(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n={start:0,end:e.length-1,maxTimes:1e3,...n};let{start:a,end:u}=n;const{returnNearestIfNoHit:r,maxTimes:i}=n;let l,c;a==null&&(a=0,u=e.length-1);let s=0,o;for(;a>=0&&a<=u;){if(s>=i)throw Error("binarySearch: loop times is over ".concat(i,", you can increase the limit."));l=Math.floor((u-a)/2+a),c=e[l];const f=s+1;if(o=t(c,l,f),o>0)u=l-1;else if(o<0)a=l+1;else return{index:l,value:c,count:f,hit:!0};s++}return r?{index:l,value:c,count:s+1,hit:!1,greater:o>0}:null}class Xt{constructor(){ge(this,"_map",new Map),ge(this,"_values",{}),ge(this,"_objCount",0)}_keysToString(t){const{_map:n}=this;let a=[];for(const u of t){if(!n.has(u))return null;a.push(n.get(u)[0])}return a.toString()}has(t){return this._keysToString(t)!=null}get(t){const{_values:n}=this,a=this._keysToString(t);if(a==null)throw"Value not found by specified keys";return n[a][1]}set(t,n){const{_map:a,_values:u}=this;let r=[];for(const i of t){let l,c=1;a.has(i)?([l,c]=a.get(i),c++):(this._objCount++,l=this._objCount.toString()),a.set(i,[l,c]),r.push(l)}u[r.toString()]=[t.slice(),n]}delete(t){const{_values:n,_map:a}=this,u=this._keysToString(t);if(u==null)throw"Value not found by specified keys";delete n[u];for(const r of t){let[i,l]=a.get(r);l--,l===0?a.delete(r):a.set(r,[i,l])}}clear(){this._map.clear(),this._values={}}*entries(){const{_values:t}=this;for(const n in t){const[a,u]=t[n];yield[a,u]}}count(){return[...this.entries()].length}}/*!
 * @virtual-list/vue
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: https://virtual-list.phphe.com
 * Released under the MIT License.
 */var ct=(e,t)=>{const n=e.__vccOpts||e;for(const[a,u]of t)n[a]=u;return n};const Yt=ve({props:{table:Boolean}}),qt={key:0},Zt={key:1};function Jt(e,t,n,a,u,r){return e.table?(k(),T("table",qt,[P(e.$slots,"prepend"),G("tbody",null,[P(e.$slots,"default")]),P(e.$slots,"append")])):(k(),T("div",Zt,[P(e.$slots,"prepend"),P(e.$slots,"default"),P(e.$slots,"append")]))}var Gt=ct(Yt,[["render",Jt]]);const Qt=ve({components:{VirtualListTable:Gt},props:{items:Array,disabled:Boolean,horizontal:Boolean,firstRender:{type:Number,default:10},buffer:{type:Number,default:100},itemKey:{type:[String,Function]},itemSize:{type:Function},table:Boolean},setup(e){const t=U(0),n=U(e.firstRender-1),a=N(()=>{var D;return Ft(n.value,(((D=e.items)==null?void 0:D.length)||1)-1)}),u=U(0),r=N(()=>d.value[t.value]?oe(t.value):0),i=N(()=>d.value.length>0?oe(d.value.length-1)+ot(f.value):0),l=N(()=>d.value[a.value]?i.value-oe(a.value)-f.value[a.value]:0),c=N(()=>e.disabled?{}:{overflow:"auto"}),s=N(()=>{const D={display:"flex"};return e.disabled||(e.horizontal?Object.assign(D,{"margin-left":r.value+"px","margin-right":l.value+"px",width:i.value-l.value-r.value+"px"}):Object.assign(D,{"margin-top":r.value+"px","margin-bottom":l.value+"px"})),D["flex-direction"]=e.horizontal?"row":"column",e.table&&(delete D.display,delete D["flex-direction"]),D}),o=N(()=>he((e.items||[]).map(()=>null))),f=N(()=>(e.items||[]).map((D,v)=>{var w;if(o[v]!=null)return o[v];let C=(w=e.itemSize)==null?void 0:w.call(e,D,v);return C==null&&(C=u.value),C})),d=N(()=>{const D=[];return f.value.reduce((v,w)=>(D.push(v),v+w),0),D});Re(()=>e.items,E);const h=N(()=>{if(!e.items||e.disabled)return;const D=[];for(let v=t.value;v<=a.value;v++){const w=e.items[v];if(!w)break;D.push({item:w,index:v})}return D}),g=U(),y=U();rt(async()=>{E();try{$e()}catch{await Te(),E()}});let b;function _(){const D=g.value;if(!D)return;const v=Q(D);b!=null&&e.buffer-Math.abs(v-b)>=10||(b=v,E())}let S=!1,B=!1;async function E(){var D;if(S){B=!0;return}if(!e.items||e.disabled)return;S=!0;const v=g.value,w=(D=y.value)==null?void 0:D.$el;if(!v||!w)return;u.value||(u.value=ye()),t.value=te(),n.value=ne(),await Te();let C,F=0;const K={},Z=e.table?w.querySelector("tbody").children:w.children;for(let M=0;M<Z.length;M++){const x=Z[M],O=Oe(x,"position");if(O&&["absolute","fixed"].includes(O))continue;const $=Oe(x,"display")!=="none"?se(x):0,I=x.getAttribute("vt-index"),re=I?parseInt(I):t.value+F;K[re]=(K[re]||0)+$,F++}for(const M of Object.keys(K)){const x=parseInt(M);o.value[x]!==K[x]&&(o.value[x]=K[x],C=!0)}C&&await Te(),S=!1,B&&(B=!1,E());function te(){const M=Q(v)-A(v)-e.buffer;return ze(d.value,O=>O-M,{returnNearestIfNoHit:!0}).index}function ne(){const M=Q(v)-A(v)+j(v)+e.buffer;return ze(d.value,O=>O-M,{returnNearestIfNoHit:!0}).index}function ye(){const x=[],O=e.table?w.querySelector("tbody").children:w.children;for(let $=0;$<O.length;$++){const I=O[$],re=getComputedStyle(I);if(["absolute","fixed"].includes(re.position))continue;const be=se(I);if(x.push(be),x.length>=10)break}return x.length===0?0:x.reduce(($,I)=>$+I,0)/x.length}}function j(D){const v=getComputedStyle(D);let w=parseFloat(e.horizontal?v.width:v.height);return v.boxSizing==="border-box"&&(e.horizontal?w=w-parseFloat(v.borderLeftWidth)-parseFloat(v.borderRightWidth):w=w-parseFloat(v.borderTopWidth)-parseFloat(v.borderBottomWidth)),w}function se(D){let v=j(D);const w=getComputedStyle(D);return e.horizontal?v+=parseFloat(w.borderLeftWidth)+parseFloat(w.borderRightWidth)+parseFloat(w.marginLeft)+parseFloat(w.marginRight):v+=parseFloat(w.borderTopWidth)+parseFloat(w.borderBottomWidth)+parseFloat(w.marginTop)+parseFloat(w.marginBottom),v=Number.isNaN(v)?0:v,v}function Q(D){return e.horizontal?D.scrollLeft:D.scrollTop}function A(D){const v=getComputedStyle(D);return e.horizontal?parseFloat(v.paddingLeft):parseFloat(v.paddingTop)}function oe(D){return d.value[D]}function $e(){const D=g.value;new ResizeObserver(w=>{for(let C of w)if(Ee(C.target,"vtlist")){E();break}}).observe(D)}function me(D,v){if(e.itemKey){if(typeof e.itemKey=="string"&&e.itemKey==="index")return v;if(typeof e.itemKey=="function")return e.itemKey(D,v)}}return{listElRef:g,listInnerRef:y,onscroll:_,listStyle:c,listInnerStyle:s,visibleItemsInfo:h,getItemKey:me,update:E,sizes:f,positions:d,runtimeSizes:o}}}),en=Qt;function tn(e,t,n,a,u,r){const i=Ke("VirtualListTable");return k(),T("div",{class:"vtlist",ref:"listElRef",style:ie(e.listStyle),onScrollPassive:t[0]||(t[0]=(...l)=>e.onscroll&&e.onscroll(...l))},[W(i,{class:"vtlist-inner",ref:"listInnerRef",style:ie(e.listInnerStyle),table:e.table},{prepend:L(()=>[P(e.$slots,"prepend")]),append:L(()=>[P(e.$slots,"append")]),default:L(()=>[e.disabled?(k(!0),T(ue,{key:0},Me(e.items,(l,c)=>P(e.$slots,"default",{key:e.getItemKey(l,c),item:l,index:c})),128)):(k(!0),T(ue,{key:1},Me(e.visibleItemsInfo,({item:l,index:c})=>P(e.$slots,"default",{key:e.getItemKey(l,c),item:l,index:c})),128))]),_:3},8,["style","table"])],36)}var nn=ct(en,[["render",tn]]);/*!
 * @he-tree/tree-utils v0.1.0-alpha.4
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const le="children";function rn(e){const n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a={...an,...n,data:e,stats:null,statsFlat:null,_statsMap:null,initialized:!1,init(){const{data:r,childrenKey:i}=this,l=new He([]);this._statsMap=new Map,X(r,(s,o,f,d)=>{const h=this.statHandler({...Ze(),data:s,open:!!this.defaultOpen,parent:l.getParent(d),children:[],level:d.length});this._statsMap.set(s,h),l.set(d,h)},{childrenKey:i});const c=[];l.walk(s=>{c.push(s)}),this.stats=this.statsHandler(l.rootChildren),this.statsFlat=this.statsFlatHandler(c),this.initialized=!0},getStat(r){let i=this._statsMap.get(r);if(!i)throw new Je("Stat not found");return i},has(r){if(r.isStat)return this.statsFlat.indexOf(r)>-1;try{return!!this.getStat(r)}catch(i){if(i instanceof Je)return!1;throw i}},_getPathByStat(r){if(r==null)return[];const l=this.getSiblings(r).indexOf(r);return[...r.parent?this._getPathByStat(r.parent):[],l]},afterOneCheckChanged(r){const{checked:i}=r;if(r._ignoreCheckedOnce)return delete r._ignoreCheckedOnce,!1;const l=c=>{const{parent:s}=c;if(s){let o,f;for(const h of s.children)if(h.checked||h.checked===0)o=!0;else if(f=!0,o&&f)break;const d=f?o?0:!1:!0;s.checked!==d&&(this._ignoreCheckedOnce(s),s.checked=d),l(s)}};return l(r),X(r.children,c=>{c.checked!==i&&(this._ignoreCheckedOnce(c),c.checked=i)},{childrenKey:le}),!0},_ignoreCheckedOnce(r){r._ignoreCheckedOnce=!0,setTimeout(()=>{r._ignoreCheckedOnce&&(r._ignoreCheckedOnce=!1)},100)},isVisible(r){const i=r.isStat?r:this.getStat(r),l=c=>!c||!c.hidden&&c.open&&l(c.parent);return!!(!i.hidden&&l(i.parent))},updateCheck(){X(this.stats,r=>{if(r.children&&r.children.length>0){const i=r.children.every(l=>l.checked);r.checked!==i&&(this._ignoreCheckedOnce(r),r.checked=i)}},{childFirst:!0,childrenKey:le})},getChecked(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.statsFlat.filter(i=>i.checked||r&&i.checked===0)},getUnchecked(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this.statsFlat.filter(i=>r?!i.checked:i.checked===!1)},openAll(){for(const r of this.statsFlat)r.open=!0},closeAll(){for(const r of this.statsFlat)r.open=!1},openNodeAndParents(r){const i=r.isStat?r:this.getStat(r);for(const l of this.iterateParent(i,{withSelf:!0}))l.open=!0},_calcFlatIndex(r,i){let l=r?this.statsFlat.indexOf(r)+1:0;const c=r?r.children:this.stats;for(let s=0;s<i;s++)l+=this._count(c[s]);return l},add(r,i,l){if(this.has(r))throw"Can't add because data exists in tree";const c=i?i.children:this.stats;l==null&&(l=c.length);const s=this.statHandler({...Ze(),open:!!this.defaultOpen,data:r,parent:i||null,children:[],level:i?i.level+1:1});this._setPosition(s,i||null,l);const o=r[this.childrenKey];if(o){const f=o.slice();for(const d of f)this.add(d,s)}},remove(r){const i=this.getSiblings(r);if(i.includes(r)){st(i,r);const l=this._flat(r);this.statsFlat.splice(this.statsFlat.indexOf(r),l.length);for(const c of l)this._statsMap.delete(c.data);return this.afterRemoveStat(r),!0}return!1},getSiblings(r){const{parent:i}=r;return i?i.children:this.stats},_setPosition(r,i,l){(i?i.children:this.stats).splice(l,0,r),r.parent=i,r.level=i?i.level+1:1;const s=this._calcFlatIndex(i,l),o=this._flat(r);this.statsFlat.splice(s,0,...o);for(const f of o)this._statsMap.has(f.data)||this._statsMap.set(f.data,f);X(r,(f,d,h)=>{h&&(f.level=h.level+1)},{childrenKey:le}),this.afterSetStat(r,i,l)},*iterateParent(r,i){let l=i!=null&&i.withSelf?r:r.parent;for(;l;)yield l,l=l.parent},move(r,i,l){if(this.has(r)){if(r.parent===i&&this.getSiblings(r).indexOf(r)===l)return!1;if(r===i)throw new Error("Can't move node to it self");if(i&&r.level<i.level){let c;for(const s of this.iterateParent(i))if(s.level===r.level){c=s;break}if(r===c)throw new Error("Can't move node to its descendant")}this.remove(r)}return this._setPosition(r,i,l),!0},_flat(r){const i=[];return X(r,l=>{i.push(l)},{childrenKey:le}),i},_count(r){return this._flat(r).length},getData(r,i){const{childrenKey:l}=this,c=new He([]);return c.childrenKey=l,X(i||this.stats,(s,o,f,d)=>{let h={...s.data,[l]:[]};r&&(h=r(h)),c.set(d,h)},{childrenKey:le}),c.data}},u=a;return a.noInitialization||u.init(),u}const an={childrenKey:"children",defaultOpen:!1,statsHandler(e){return e},statsFlatHandler(e){return e},afterSetStat(e,t,n){},afterRemoveStat(e){},statHandler(e){return e}};function Ze(){return{isStat:!0,hidden:!1,checked:!1,style:null,class:null,draggable:null,droppable:null}}class Je extends Error{constructor(t){super(t),this.name="StatNotFoundError"}}/*!
 * drag-event-service v2.0.0
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const De={start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"]},Le={isTouch(e){return e.type&&e.type.startsWith("touch")},_getStore(e){return e._wrapperStore||(e._wrapperStore=[]),e._wrapperStore},on(e,t,n,a){const{args:u,mouseArgs:r,touchArgs:i}=Ge(a),l=this._getStore(e),c=this,s=function(o){let f;if(c.isTouch(o))f={x:o.changedTouches[0].pageX,y:o.changedTouches[0].pageY,pageX:o.changedTouches[0].pageX,pageY:o.changedTouches[0].pageY,clientX:o.changedTouches[0].clientX,clientY:o.changedTouches[0].clientY,screenX:o.changedTouches[0].screenX,screenY:o.changedTouches[0].screenY};else if(f={x:o.pageX,y:o.pageY,pageX:o.pageX,pageY:o.pageY,clientX:o.clientX,clientY:o.clientY,screenX:o.screenX,screenY:o.screenY},t==="start"&&o.which!==1)return;return n.call(this,o,f)};l.push({handler:n,wrapper:s}),Y.call(null,e,De[t][0],s,...u,...r),Y.call(null,e,De[t][1],s,...u,...i)},off(e,t,n,a){const{args:u,mouseArgs:r,touchArgs:i}=Ge(a),l=this._getStore(e);for(let c=l.length-1;c>=0;c--){const{handler:s,wrapper:o}=l[c];n===s&&(q.call(null,e,De[t][0],o,...u,...r),q.call(null,e,De[t][1],o,...u,...r),l.splice(c,1))}}};function Ge(e){e||(e={});const t=e.args||[],n=e.mouseArgs||[],a=e.touchArgs||[];return{args:t,mouseArgs:n,touchArgs:a}}/*!
 * @he-tree/dnd-utils v0.1.0-alpha.4
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const Ne=new Map,J={triggerElement:null,dragElement:null,internal:!1,dropEffect:"none",preventDefault:!1},z=J;function fe(e){e.dataTransfer&&(e.dataTransfer.dropEffect=z.dropEffect)}function ln(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ne.has(e))throw"Already registered on specified element";const n={...t},a=n;dt(n,sn),Le.on(e,"start",u,{touchArgs:[{passive:!0}]}),Le.on(e,"end",r);function u(f){var d;const h=f.target;h.nodeType===Node.ELEMENT_NODE&&(z.triggerElement=h);const g=h;if(n.ingoreHTMLTags&&g.tagName&&n.ingoreHTMLTags.find(b=>b.toUpperCase()===g.tagName))return;const y=(d=n.beforeDragStart)===null||d===void 0?void 0:d.call(n,f);y&&(y.setAttribute("draggable","true"),z.dragElement=y)}function r(f){z.dragElement&&z.dragElement.removeAttribute("draggable")}function i(f){var d;z.internal=!0,(d=n.onDragStart)===null||d===void 0||d.call(n,f),fe(f)}function l(f){var d;(d=n.onDrag)===null||d===void 0||d.call(n,f),fe(f)}function c(f){var d;(d=n.onDragEnd)===null||d===void 0||d.call(n,f),z.internal=!1,z.dragElement&&z.dragElement.removeAttribute("draggable"),z.triggerElement=null,z.dragElement=null,z.dropEffect="none"}const s=dn(e,{onDragLeave(f){var d;(d=n.onDragLeave)===null||d===void 0||d.call(n,f),fe(f)},onDragEnter(f){var d;a.ifPreventDefault(f)&&f.preventDefault(),(d=n.onDragEnter)===null||d===void 0||d.call(n,f),fe(f)},onDragOver(f){var d;a.ifPreventDefault(f)&&f.preventDefault(),(d=n.onDragOver)===null||d===void 0||d.call(n,f),fe(f)},onDrop(f){var d;a.ifPreventDefault(f)&&f.preventDefault(),(d=n.onDrop)===null||d===void 0||d.call(n,f)},onEnter(f){var d;(d=n.onEnter)===null||d===void 0||d.call(n,f)},onLeave(f){var d;(d=n.onLeave)===null||d===void 0||d.call(n,f)}});return Y(e,"dragstart",i),Y(e,"drag",l),Y(e,"dragend",c),Object.assign(n,{root:e,destroy:()=>{Le.off(e,"start",u,{touchArgs:[{passive:!0}]}),q(e,"dragstart",i),q(e,"drag",l),q(e,"dragend",c),s(),Ne.delete(e)}}),Ne.set(e,a),a}const sn={ingoreHTMLTags:["INPUT","TEXTAREA","SELECT","OPTGROUP","OPTION"],ifPreventDefault(e){return J.dragElement?!0:z.preventDefault},beforeDragStart(e){},onDragStart(e){},onDrag(e){},onDragEnter(e){},onDragLeave(e){},onDragOver(e){},onDragEnd(e){},onDrop(e){}};let ke=null;const on=e=>{ke=e,setTimeout(()=>{ke=null},20)};function dn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e;let a=!1;const u=h=>{var g;a=!0,(g=t.onEnter)===null||g===void 0||g.call(t,h),o.resume()},r=h=>{var g;on(h.target),(g=t.onDragEnter)===null||g===void 0||g.call(t,h),a||u(h)},i=h=>{var g;a||u(h),(g=t.onDragOver)===null||g===void 0||g.call(t,h)},l=h=>{var g;(g=t.onDragLeave)===null||g===void 0||g.call(t,h);const y=function(){var _;let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h;a=!1,(_=t.onLeave)===null||_===void 0||_.call(t,S),o.stop()},b=ke;ke=null,b&&jt(b,n)||y()},c=h=>{var g;(g=t.onDrop)===null||g===void 0||g.call(t,h)},s=h=>{var g;h instanceof KeyboardEvent&&h.key!=="Escape"||(a=!1,o.stop(),(g=t.onEndBeforeLeave)===null||g===void 0||g.call(t,h))},o=Wt([[e,"drop",s],[window,"mouseup",s],[window,"touchend",s],[window,"keydown",s]]);o.stop();const f=()=>{Y(e,"dragenter",r),Y(e,"dragover",i),Y(e,"dragleave",l),Y(e,"drop",c)},d=()=>{q(e,"dragenter",r),q(e,"dragover",i),q(e,"dragleave",l),q(e,"drop",c),o.stop()};return f(),d}var un=Object.defineProperty,cn=Object.defineProperties,fn=Object.getOwnPropertyDescriptors,Qe=Object.getOwnPropertySymbols,hn=Object.prototype.hasOwnProperty,gn=Object.prototype.propertyIsEnumerable,et=(e,t,n)=>t in e?un(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ft=(e,t)=>{for(var n in t||(t={}))hn.call(t,n)&&et(e,n,t[n]);if(Qe)for(var n of Qe(t))gn.call(t,n)&&et(e,n,t[n]);return e},pn=(e,t)=>cn(e,fn(t)),ht=(e,t)=>{const n=e.__vccOpts||e;for(const[a,u]of t)n[a]=u;return n};let xe=!1;const vn=()=>{xe=!0,setTimeout(()=>{xe=!1},100)},mn=ve({props:["stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor"],emits:["open","close","check"],setup(e,{emit:t}){const n=N(()=>({[e.rtl?"paddingRight":"paddingLeft"]:e.indent*(e.stat.level-1)+"px"}));Re(()=>e.stat.checked,r=>{xe||e.processor.afterOneCheckChanged(e.stat)&&t("check",e.stat)}),Re(()=>e.stat.open,r=>{xe||(t(r?"open":"close",e.stat),vn())});const a=N(()=>{const r=[],i=o=>{var f;if(o.parent){let d=(f=o.parent)==null?void 0:f.children.indexOf(o);do{d++;let h=o.parent.children[d];if(h){if(!h.hidden)return!0}else break}while(!0)}return!1},l=e.rtl?"right":"left",c=e.btt?"top":"bottom";let s=e.stat;for(;s;){let o=(s.level-2)*e.indent+e.treeLineOffset;const f=i(s),d=()=>{r.push({style:{[l]:o+"px",[c]:f?0:"50%"}})};s===e.stat?s.level>1&&d():f&&d(),s=s.parent}return r}),u=N(()=>{let r=(e.stat.level-2)*e.indent+e.treeLineOffset;return{[e.rtl?"right":"left"]:r+"px"}});return{indentStyle:n,vLines:a,hLineStyle:u}}}),yn=mn,bn={class:"tree-node-inner"},Dn={key:1,class:"tree-node",ref:"el"};function Sn(e,t,n,a,u,r){return e.table?(k(),T("tr",Dn,[P(e.$slots,"default",{indentStyle:e.indentStyle})],512)):(k(),T("div",{key:0,class:we(["tree-node",{"tree-node--with-tree-line":e.treeLine}]),style:ie(e.indentStyle),ref:"el"},[e.treeLine?(k(),T(ue,{key:0},[(k(!0),T(ue,null,Me(e.vLines,i=>(k(),T("div",{class:"tree-line tree-vline",style:ie(i.style)},null,4))),256)),e.stat.level>1?(k(),T("div",{key:0,class:"tree-line tree-hline",style:ie(e.hLineStyle)},null,4)):Ve("",!0)],64)):Ve("",!0),G("div",bn,[P(e.$slots,"default",{indentStyle:e.indentStyle})])],6))}var Cn=ht(yn,[["render",Sn]]);function wn(e,t={}){const n=pn(ft({},t),{statHandler(a){return this._statHandler2&&(a=this._statHandler2(a)),Be(t.statHandler,he(a))},statsHandler(a){return Be(t.statsHandler,he(a))},statsFlatHandler(a){return Be(t.statsFlatHandler,he(a))}});return rn(e,n)}function Be(e,t){return e?e(t):t}const _n=ve({components:{VirtualList:nn,TreeNode:Cn},props:{value:{required:Tt,type:Array},modelValue:{required:Pt,type:Array},updateBehavior:{type:String,default:"modify"},processor:{type:Object,default:()=>wn([],{noInitialization:!0})},childrenKey:{type:String,default:"children"},textKey:{type:String,default:"text"},indent:{type:Number,default:20},virtualization:{type:Boolean,default:!1},virtualizationPrerenderCount:{type:Number,default:20},defaultOpen:{type:Boolean,default:!0},statHandler:{type:Function},rtl:{type:Boolean,default:!1},btt:{type:Boolean,default:!1},table:{type:Boolean,default:!1},watermark:{type:Boolean,default:!1},nodeKey:{type:[String,Function],default:"index"},treeLine:{type:Boolean,default:!1},treeLineOffset:{type:Number,default:8}},emits:["update:modelValue","click:node","open:node","close:node","check:node","beforeDragStart","before-drag-start","after-drop","change","enter","leave"],data(){return{stats:[],statsFlat:[],dragNode:null,dragOvering:!1,placeholderData:{},placeholderColspan:1,batchUpdateWaiting:!1,self:this,_ignoreValueChangeOnce:!1}},computed:{valueComputed(){return this.modelValue||[]},visibleStats(){const{statsFlat:e,isVisible:t}=this;let n=e;return this.btt&&(n=n.slice(),n.reverse()),n.filter(a=>t(a))},rootChildren(){return this.stats}},methods:{_emitValue(e){this.$emit("update:modelValue",e)},_updateValue(e){return this.updateBehavior==="disabled"?!1:(e!==this.valueComputed&&(this._ignoreValueChangeOnce=!0),this._emitValue(e),!0)},getStat:Fe(R("getStat")),has:Fe(R("has")),updateCheck:R("updateCheck"),getChecked:R("getChecked"),getUnchecked:R("getUnchecked"),openAll:R("openAll"),closeAll:R("closeAll"),openNodeAndParents:R("openNodeAndParents"),isVisible:R("isVisible"),move:tt("move"),add:Fe(tt("add")),addMulti(e,t,n){this.batchUpdate(()=>{let a=n;for(const u of e)this.add(u,t,a),a!=null&&a++})},remove:R("remove"),removeMulti(e){this.batchUpdate(()=>{for(const t of e)this.remove(t)})},iterateParent:R("iterateParent"),getSiblings:R("getSiblings"),getData:R("getData"),getRootEl(){return this.$refs.vtlist.listElRef},batchUpdate(e){const t=this.ignoreUpdate(e);return this.batchUpdateWaiting||this._updateValue(this.updateBehavior==="new"?this.getData():this.valueComputed),t},ignoreUpdate(e){const t=this.batchUpdateWaiting;this.batchUpdateWaiting=!0;const n=e();return this.batchUpdateWaiting=t,n}},watch:{processor:{immediate:!0,handler(e){if(e){const t=n=>{if(n){const{childrenKey:a}=this;return n[a]||(n[a]=[]),n[a]}else return this.valueComputed};e._statHandler2=this.statHandler?n=>n.data===this.placeholderData?n:this.statHandler(n):null,e.afterSetStat=(n,a,u)=>{const{childrenKey:r,updateBehavior:i}=this;let l=this.valueComputed;if(i==="new"){if(this.batchUpdateWaiting)return;l=this.getData()}else if(i==="modify"){const c=t(a==null?void 0:a.data);c.includes(n.data)||c.splice(u,0,n.data)}this.batchUpdateWaiting||this._updateValue(l)},e.afterRemoveStat=n=>{var a;const{childrenKey:u,updateBehavior:r}=this;let i=this.valueComputed;if(r==="new"){if(this.batchUpdateWaiting)return;i=this.getData()}else if(r==="modify"){const l=t((a=n.parent)==null?void 0:a.data);st(l,n.data)}this.batchUpdateWaiting||this._updateValue(i)}}e.initialized||(e.data=this.valueComputed,Object.assign(e,At(this,["childrenKey","defaultOpen"])),e.init(),e.updateCheck()),this.stats=e.stats,this.statsFlat=e.statsFlat,e.data!==this.valueComputed&&this._updateValue(e.data)}},valueComputed:{handler(e){if(this.dragOvering||this.dragNode||this._ignoreValueChangeOnce)this._ignoreValueChangeOnce=!1;else{const{processor:n}=this;n.data=e,n.init(),this.stats=n.stats,this.statsFlat=n.statsFlat}}}},created(){},mounted(){this.watermark===!1&&(window._heTreeWatermarkDisabled=!0),this.watermark&&!window._heTreeWatermarkDisabled&&(window._heTreeWatermark||(window._heTreeWatermark=!0,console.log("%c[he-tree] Vue tree component:  https://hetree.phphe.com","color:#0075ff; font-size:14px;")))}}),En=_n;function R(e){return function(...t){return this.processor[e](...t)}}function tt(e){return function(...t){return this.batchUpdate(()=>this.processor[e](...t))}}function Fe(e){return function(t,...n){return t&&(t=he(t)),e.call(this,t,...n)}}const On={key:0,class:"drag-placeholder he-tree-drag-placeholder"},kn=["colspan"],xn={class:"drag-placeholder he-tree-drag-placeholder"};function $n(e,t,n,a,u,r){const i=Ke("TreeNode"),l=Ke("VirtualList");return k(),Ue(l,{class:we(["he-tree",{"he-tree--rtl rtl":e.rtl,"he-tree--drag-overing drag-overing":e.dragOvering}]),ref:"vtlist",items:e.visibleStats,disabled:!e.virtualization,table:e.table,itemKey:e.nodeKey},{prepend:L(()=>[P(e.$slots,"prepend",{tree:e.self})]),default:L(({item:c,index:s})=>[W(i,{"vt-index":s,class:we([c.class,{"drag-placeholder-wrapper":c.data===e.placeholderData,"dragging-node":c===e.dragNode}]),style:ie(c.style),stat:c,rtl:e.rtl,btt:e.btt,indent:e.indent,table:e.table,treeLine:e.treeLine,treeLineOffset:e.treeLineOffset,processor:e.processor,onClick:o=>e.$emit("click:node",c),onOpen:t[0]||(t[0]=o=>e.$emit("open:node",o)),onClose:t[1]||(t[1]=o=>e.$emit("close:node",o)),onCheck:t[2]||(t[2]=o=>e.$emit("check:node",o))},{default:L(({indentStyle:o})=>[c.data===e.placeholderData?(k(),T(ue,{key:0},[e.table?(k(),T("td",{key:1,style:ie(o),colspan:e.placeholderColspan},[G("div",xn,[P(e.$slots,"placeholder",{tree:e.self})])],12,kn)):(k(),T("div",On,[P(e.$slots,"placeholder",{tree:e.self})]))],64)):P(e.$slots,"default",{key:1,node:c.data,stat:c,indentStyle:o,tree:e.self},()=>[ee(at(c.data[e.textKey]),1)])]),_:2},1032,["vt-index","class","style","stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor","onClick"])]),append:L(()=>[P(e.$slots,"append",{tree:e.self})]),_:3},8,["class","items","disabled","table","itemKey"])}var Tn=ht(En,[["render",$n]]);let m=null,p=null,Ie,Se,ae,Ce,Ae,V;const Pn=ve({extends:Tn,props:{triggerClass:{type:[String,Array]},disableDrag:Boolean,disableDrop:Boolean,eachDraggable:{type:Function},eachDroppable:{type:Function},rootDroppable:{type:[Boolean,Function],default:!0},dragOpen:{type:Boolean,default:!0},dragOpenDelay:{type:Number,default:0},beforeDragOpen:{type:Function},resolveStartMovePoint:{type:[String,Function]},keepPlaceholder:{type:Boolean},maxLevel:{type:Number},dragCopy:{type:Boolean},dragCopyDataHandler:{type:Function},onExternalDragOver:{type:Function},externalDataHandler:{type:Function},ondragstart:{type:Function}},data(){return{treeDraggableInstance:null}},computed:{},methods:{getNodeByElement(e){const t=e.getAttribute("vt-index");return t==null?null:this.visibleStats[t]},isDraggable(e){if(this.disableDrag)return!1;if(e.draggable!=null)return e.draggable;if(this.eachDraggable){const n=this.eachDraggable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDraggable(t):!0},isDroppable(e){if(this.disableDrop)return!1;if(!e)return Xe(this.rootDroppable,[this,m]);if(e.droppable!=null)return e.droppable;if(this.eachDroppable){const n=this.eachDroppable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDroppable(t):!0},_eachDroppable(){var e;return Xe((e=this._isDragCopy)==null?void 0:e.call(this),[this])}},mounted(){const e=(s,o)=>{let f=!0;return m&&m!==this&&(f=f&&this._isMoved),this.table&&!this._isDragCopy&&(f=f&&this._isDragCopy),f&&(s.x!==o.x||s.y!==o.y)},t=(s,o)=>{p.ignoreUpdate(()=>{if(!p.has(p.placeholderData)){if(p.table){let d=0;const h=p.getRootEl().querySelector("tr");if(h)for(const{value:g}of Kt(h.children))Oe(g,"display")!=="none"&&(d+=g.colSpan||1);d<1&&(d=1),p.placeholderColspan=d}p.add(p.placeholderData)}const f=p.getStat(p.placeholderData);p.move(f,s,o)})},n=()=>{const s=this;if(s.has(s.placeholderData))return s.remove(s.getStat(s.placeholderData)),!0},a=s=>{s?J.dropEffect=m!=null&&m.dragCopy?"copy":"move":J.dropEffect="none"},u=s=>{const o=this;s?a(!0):o.keepPlaceholder?o.has(o.placeholderData)||a(!1):(n(),a(!1))};let r={x:0,y:0};const i=this.getRootEl();let l=null;const c=()=>{p.has(p.placeholderData)&&p.ignoreUpdate(()=>{p.remove(p.getStat(p.placeholderData)),m&&(m.dragNode.hidden=!1,m.dragOvering=!1)})};this.treeDraggableInstance=ln(i,{beforeDragStart:s=>{if(!J.triggerElement)return;let o=this.triggerClass;(!o||o.length===0)&&(o="tree-node");let f=It(o),d=Ye(J.triggerElement,h=>{if(qe(h,f))return!0;if(Ee(h,"tree-node"))return"break"},{withSelf:!0,until:i});if(l=Ye(d,h=>{if(Ee(h,"tree-node"))return!0},{withSelf:!0,until:i}),!!l){if(V=this.getNodeByElement(l),!V)throw"Can't find drag node";if(this.isDraggable(V))return this.$emit("before-drag-start",V),this.$emit("beforeDragStart",V),i}},onDragStart:s=>{var o,f,d;if(!l||!V)return;{const{x:b,y:_}=l.getBoundingClientRect(),{clientX:S,clientY:B}=s;(o=s.dataTransfer)==null||o.setDragImage(l,S-b,B-_)}Ae={x:s.clientX,y:s.clientY},m=this,m.dragNode=V,Ce=(()=>{if(this.resolveStartMovePoint==="mouse")return{x:s.clientX,y:s.clientY};if(typeof this.resolveStartMovePoint=="function")return this.resolveStartMovePoint(l);{let b,_=0;if(this.table){let S=l.getBoundingClientRect();b={x:S.x,y:S.y},this.rtl&&(b.x=S.right),_=S.height}else if(!this.rtl)b=l.children[0].getBoundingClientRect().toJSON(),_=b.height;else{const S=l.children[0].getBoundingClientRect();b={x:S.right,y:S.y},_=S.height}return this.btt&&(b.y+=_),b}})(),this.dragOvering=!0;const g=m.getSiblings(m.dragNode),y=g.indexOf(V);Ie={tree:m,dragNode:V,parent:V.parent,siblings:g,indexBeforeDrop:y},p=this,(f=s.dataTransfer)==null||f.setData("text",`he-tree drag start at ${new Date().toISOString()}`),m._eachDroppable()||setTimeout(()=>{V.hidden=!0,t(V.parent,y+1)},0),(d=this.ondragstart)==null||d.call(this,s)},onEnter:s=>{this.$emit("enter",s)},onLeave:s=>{ae=null,this.dragOvering=!1,J.preventDefault=!1,n(),this.$emit("leave",s)},onDragOver:zt(s=>{if(!m){if(!this.onExternalDragOver||this.onExternalDragOver(s)===!1)return;J.preventDefault=!0}const o={x:s.clientX,y:s.clientY},f=e(o,r);if(r=o,!f)return;this.dragOvering=!0,p=this;const d=Ce?{x:Ce.x+(o.x-Ae.x),y:Ce.y+(o.y-Ae.y)}:ft({},o),{btt:h,rtl:g}=p;if(p.disableDrop){J.dropEffect="none";return}let y,b;const _=p.getRootEl().querySelectorAll(".tree-node"),S=[];_.forEach(C=>{!qe(C,["drag-placeholder-wrapper","dragging-node"])&&Oe(C,"display")!=="none"&&S.push(C)});const B=ze(S,C=>Pe(C)[h?"bottom":"top"]-d.y,{returnNearestIfNoHit:!0});let E=null,j,se;B.hit||(B.greater?h||(E=B.index-1,S[E]||E++):h&&(E=B.index+1,S[E]||E--)),E==null&&(E=B.index),j=S[E],se=h?S[E-1]:S[E+1],y=j&&p.getNodeByElement(j),b=se&&p.getNodeByElement(se);const{indent:Q}=p,A=ce(()=>{if(p.table){let C=Pe(j).toJSON();const F=Q*(y.level-1);return g?(C.width-=F,C.right-=F):C.x+=F,C}else return Pe(j.firstElementChild)}).action,oe=ce(()=>h?d.y>A().y+A().height/2:d.y<A().y+A().height/2).action,$e=ce(()=>h?!j||E===S.length-1&&oe():!j||E===0&&oe()).action,me=ce(()=>g?d.x-(A().x+A().width):A().x-d.x).action,D=ce(()=>g?d.x<A().x+A().width-Q:d.x>A().x+Q).action;let v;if($e())v=1,y=null;else if(y)me()>0?v=y.level-Math.ceil(me()/Q):D()?v=y.level+1:v=y.level;else return;b&&v<b.level&&(v=b.level),(async()=>{let C,F,K=!1,Z=null;const te=async O=>{if(O.open)return!0;if(p.dragOpen)if(p.dragOpenDelay)if(Z=O,ae===O)K=!0;else{let $=Ut();ae=O;const I=O;return setTimeout(async()=>{I!==ae?(K=!0,$.resolve(!0)):(p.beforeDragOpen&&await p.beforeDragOpen(O),I!==ae?(K=!0,$.resolve(!0)):(O.open=!0,Z=null,$.resolve(!0)))},p.dragOpenDelay),await $.promise}else return O.open=!0,!0;else return!1},ne=async()=>{if(p.isDroppable(y)&&await te(y)){if(K)return;C=y,F=null}else return!1},ye=(O=v)=>{let $=y,I=[];for(;$&&$.level>=O;)$=$.parent||null,I.unshift($);let re=0;for(const be of I){if(p.isDroppable(be))return C=be,F=I[re+1]||y,!0;re++}return!1};y?v>y.level?await ne()===!1&&ye(y.level):ye()===!1&&await ne():p.isDroppable(null)&&(C=null),ae=Z;const M=!!(!K&&(C||C===null));return{cancelled:K,success:M,parent:C,index:M?F?(C?C.children:p.stats).filter(O=>O.data!==p.placeholderData).indexOf(F)+1:0:-1}})().then(C=>{if(!C.cancelled){if(!C.success){u(!1);return}if(p.maxLevel!=null&&p.maxLevel>0){let F=1;if(m){const Z=m.dragNode;let te=0;X(Z,ne=>{ne.level>te&&(te=ne.level)},{childrenKey:le}),F=te-Z.level+1}if(F+(C.parent?C.parent.level:0)>p.maxLevel){u(!1);return}}u(!0),t(C.parent,C.index)}})},()=>{}),onDrop:s=>{p=this;const o=!m;if(!p)return;const f=m==null?void 0:m.dragNode;let d,h=(()=>{var g;let y=!0;if(!p.has(p.placeholderData))y=!1;else if(o)d=(g=this.externalDataHandler)==null?void 0:g.call(this,s),y=d!=null;else if(!m.dragCopy){const b=p.getStat(p.placeholderData);m===p&&b.parent===f.parent&&Ht(f,_=>_===b)}return y})();if(h){const g=p.getStat(p.placeholderData),y=p.getSiblings(g);Se={tree:p,dragNode:f,parent:g.parent,siblings:y,indexBeforeDrop:y.indexOf(g)}}(()=>{if(c(),h){let g=Se.indexBeforeDrop;m&&!m.dragCopy&&m===p&&Ie.parent==Se.parent&&Ie.indexBeforeDrop<g&&g--,m&&m!==p&&!m._eachDroppable()&&m.batchUpdate(()=>{m.remove(f),m.updateCheck()}),p.batchUpdate(()=>{let y=m==null?void 0:m.dragNode,b;d?b=d:m._eachDroppable()&&(b=ut(m.dragNode.data,{childrenKey:m.childrenKey}),m.dragCopyDataHandler&&(b=m.dragCopyDataHandler(b))),b&&(p.add(b),y=p.getStat(b)),p.move(y,Se.parent,g),p.updateCheck()})}p.$emit("after-drop"),h&&(m&&(m.dragCopy||m.$emit("change")),p!==m&&p.$emit("change"))})()},onDragEnd:s=>{c(),m&&(m.dragNode&&(m.dragNode.hidden=!1),m.dragNode=null,m.dragOvering=!1,m=null),p=null,ae=null,V=null}})},unmounted(){var e;(e=this.treeDraggableInstance)==null||e.destroy()}}),Ln={__name:"BaseTree",props:{options:Array,treeRef:null},emits:["update:options","update:treeRef"],setup(e,{emit:t}){const n=e,a=t,u=U(null),r=N({get(){return n.options},set(i){a("update:options",i)}});return rt(()=>{a("update:treeRef",u.value)}),(i,l)=>(k(),Ue(H(Pn),{class:"base-tree",modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=c=>r.value=c),ref_key:"tree",ref:u,"tree-line":"","tree-line-offset":8,indent:25,onChange:l[1]||(l[1]=c=>i.$emit("change"))},{default:L(({node:c,stat:s})=>[P(i.$slots,"default",{node:c,stat:s})]),_:3},8,["modelValue"]))}};function Nn(){this.id=de("id"),this.text=de("title"),this.children=de("children",this)}const Bn=lt(new Nn),Fn=it(Bn);function In(){this.id=de("id"),this.title=de("text"),this.children=de("children",this)}const An=lt(new In),Kn=it(An),Mn=[{text:"",id:2,children:[{text:"",id:21},{text:"",id:22},{text:"",id:23,children:[{text:"",id:211},{text:"",id:221}]}]},{text:"",id:4,children:[{text:"",id:41},{text:"",id:42}]}],Rn=e=>(yt("data-v-b0d4ca68"),e=e(),bt(),e),Vn={key:0},Hn={class:"node-text"},zn={class:"node-actions"},Un={key:1,class:"no-categories"},jn=Rn(()=>G("span",{class:"no-categories-text"}," Нет добавленных категорий ",-1)),Wn={__name:"CategoriesPage",setup(e){const t=gt(),n=pt(),a=async function(){t.fetchMany({page:1,perPage:999})};a();const u=N(()=>t.isManyLoading?Mn:Fn(t.listData)),r=U(!1),i=U(null),l=U(!1),c=U(null),s=function(){const b=c.value.getData();l.value=!1,t.editMany(Kn(b))},o=function(b){n.push({name:"EditCategory",params:{id:b}})},f=function(b){r.value=!0,i.value=b},d=async function(){await t.deleteOne(i.value),a()},h=U(!1),g=U(null);vt(b=>{if(!g.value&&l.value)return h.value=!0,g.value=b,!1});const y=function(){n.push({name:g.value.name})};return(b,_)=>(k(),T(ue,null,[G("div",null,[H(t).isManyLoading||H(t).listData.length>0?(k(),T("div",Vn,[W(H(Ln),{options:u.value,onChange:_[0]||(_[0]=S=>l.value=!0),"tree-ref":c.value,"onUpdate:treeRef":_[1]||(_[1]=S=>c.value=S)},{default:L(({node:S})=>[G("div",{class:we(["node-wrapper",{loading:H(t).isManyLoading}])},[W(H($t),{class:"icon-bars"}),G("span",Hn,at(S.text),1),G("div",zn,[W(H(Ct),{class:"node-edit",onClick:B=>o(S.id)},null,8,["onClick"]),W(H(St),{class:"node-delete",onClick:B=>f(S.id)},null,8,["onClick"])])],2)]),_:1},8,["options","tree-ref"]),l.value?(k(),Ue(H(wt),{key:0,class:"save-button",onClick:s},{default:L(()=>[ee(" Сохранить изменения ")]),_:1})):Ve("",!0)])):(k(),T("div",Un,[W(H(Dt),{class:"no-categories-icon"}),jn,W(H(mt),{class:"add-category",to:{name:"AddCategory"}},{default:L(()=>[ee(" Добавить категорию ")]),_:1})]))]),W(H(je),{modelValue:r.value,"onUpdate:modelValue":_[2]||(_[2]=S=>r.value=S),onAccept:d,onClose:_[3]||(_[3]=S=>i.value=null)},{title:L(()=>[ee(" Удаление категории ")]),description:L(()=>[ee(" Вы уверены, что хотите удалить эту категорию? ")]),_:1},8,["modelValue"]),W(H(je),{modelValue:h.value,"onUpdate:modelValue":_[4]||(_[4]=S=>h.value=S),"should-emit-close-after-accept":!1,onAccept:y,onClose:_[5]||(_[5]=S=>g.value=null)},{title:L(()=>[ee(" Есть несохраненные изменения ")]),description:L(()=>[ee(" Вы уверены, что хотите покинуть эту страницу? Изменения будут утеряны ")]),accept:L(()=>[ee(" Перейти ")]),_:1},8,["modelValue"])],64))}},Qn=nt(Wn,[["__scopeId","data-v-b0d4ca68"]]);export{Qn as default};
