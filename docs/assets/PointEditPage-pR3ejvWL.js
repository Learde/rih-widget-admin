import{u as D,B as E,a as S,b as T,r as $}from"./BaseInput-DlL1WrLb.js";import{T as P,a4 as b,N as L,g as h,P as k,A as f,k as g,q as F,a3 as I,o as M,c as O,a as _,b as i,w as c,u as o,F as q,f as V,x as R}from"./index-iYkTLCFw.js";import{B as U}from"./BaseFormGroup-oGxs-sNh.js";const z={__name:"PointEditPage",props:{id:{type:[String,Number],default:null}},setup(B){const a=B,w=P(),m=b(),n=L(),y=h(),e=k({title:""}),u=f(!1),r=D({formData:{title:{required:$}}},{formData:e}),p=g(()=>!r.value.formData.title.$error),N=g(()=>r.value.formData.title.$errors),x=function(){r.value.formData.title.$touch()},s=f("pending");return F(async()=>{if(a.id){s.value="loading";const d=await n.getOne(a.id);s.value="pending",e.title=d.title}m.addEventListener("ready",async()=>{if(!await r.value.$validate()){u.value=!0;return}s.value="loading",a.id?await n.editOne(a.id,{id:a.id,title:e.title}):await n.addOne({title:e.title}),s.value="success",setTimeout(()=>{y.push({name:"Points"})},1500)})}),I(()=>{m.clearEventListeners("ready")}),(d,l)=>(M(),O(q,null,[_("div",null,[i(o(U),{"is-error":!p.value},{label:c(()=>[V(" Название пункта проката * ")]),content:c(()=>[i(o(E),{placeholder:"Введите название","is-error":!p.value,modelValue:e.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.title=t),onInput:x},null,8,["is-error","modelValue"])]),"error-text":c(()=>{var t,v;return[V(R(o(w).validationMessages[(v=(t=N.value)==null?void 0:t.at(0))==null?void 0:v.$validator]),1)]}),_:1},8,["is-error"])]),i(o(S),{state:s.value},null,8,["state"]),i(o(T),{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=t=>u.value=t),type:"error"},null,8,["modelValue"])],64))}};export{z as default};
