import{u as D,B as E,a as S,b as x,r as T}from"./BaseInput-nVZfDFq2.js";import{N as b,Z as L,$ as M,z as P,M as h,q as f,f as V,j as F,Y as I,o as O,c as _,a as k,b as i,w as c,u as o,F as q,d as g,t as R}from"./index-pjyOXBHH.js";import{B as U}from"./BaseFormGroup-Kj1VUKRp.js";const Y={__name:"PointEditPage",props:{id:{type:[String,Number],default:null}},setup(B){const a=B,w=b(),m=L(),n=M(),y=P(),e=h({title:""}),u=f(!1),r=D({formData:{title:{required:T}}},{formData:e}),p=V(()=>!r.value.formData.title.$error),N=V(()=>r.value.formData.title.$errors),$=function(){r.value.formData.title.$touch()},s=f("pending");return F(async()=>{if(a.id){s.value="loading";const d=await n.getOne(a.id);s.value="pending",e.title=d.title}m.addEventListener("ready",async()=>{if(!await r.value.$validate()){u.value=!0;return}s.value="loading",a.id?await n.editOne(a.id,{id:a.id,title:e.title}):await n.addOne({title:e.title}),s.value="success",setTimeout(()=>{y.push({name:"Points"})},1500)})}),I(()=>{m.clearEventListeners("ready")}),(d,l)=>(O(),_(q,null,[k("div",null,[i(o(U),{"is-error":!p.value},{label:c(()=>[g(" Название пункта проката * ")]),content:c(()=>[i(o(E),{placeholder:"Введите название","is-error":!p.value,modelValue:e.title,"onUpdate:modelValue":l[0]||(l[0]=t=>e.title=t),onInput:$},null,8,["is-error","modelValue"])]),"error-text":c(()=>{var t,v;return[g(R(o(w).validationMessages[(v=(t=N.value)==null?void 0:t.at(0))==null?void 0:v.$validator]),1)]}),_:1},8,["is-error"])]),i(o(S),{state:s.value},null,8,["state"]),i(o(x),{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=t=>u.value=t),type:"error"},null,8,["modelValue"])],64))}};export{Y as default};
