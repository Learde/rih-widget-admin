import{u as x,B as S,a as $,b as M,r as T}from"./BaseInput-nVZfDFq2.js";import{N as C,Z as L,G as q,z as F,M as I,q as n,f as V,j as _,Y as k,o as G,c as P,a as R,b as u,w as p,u as s,F as U,D as j,d as B,t as z}from"./index-pjyOXBHH.js";import{B as O}from"./BaseFormGroup-Kj1VUKRp.js";const J={__name:"CategoryEditPage",props:{id:{type:[String,Number],required:!0}},setup(h){const N=h,y=C(),m=L(),f=q(),D=F(),r=I({title:""}),i=n(!1),l=x({formData:{title:{required:T}}},{formData:r}),g=V(()=>!l.value.formData.title.$error),w=V(()=>l.value.formData.title.$errors),E=function(){l.value.formData.title.$touch()},o=n("pending"),d=n([]),c=n(null),b=function(v){var e;const a=j.clone(d.value);for(;a.length>0;){const t=a.pop();if(Number(t.id)===Number(v))return t;((e=t==null?void 0:t.children)==null?void 0:e.length)>0&&a.push(...t.children)}};return _(async()=>{o.value="loading",d.value=await f.fetchMany({page:1,perPage:999}),c.value=b(N.id),r.title=c.value.title,o.value="pending",m.addEventListener("ready",async()=>{if(!await l.value.$validate()){i.value=!0;return}o.value="loading",c.value.title=r.title,await f.editOne(null,d.value),o.value="success",setTimeout(()=>{D.push({name:"Categories"})},1500)})}),k(()=>{m.clearEventListeners("ready")}),(v,a)=>(G(),P(U,null,[R("div",null,[u(s(O),{"is-error":!g.value},{label:p(()=>[B(" Название категории * ")]),content:p(()=>[u(s(S),{placeholder:"Введите название","is-error":!g.value,modelValue:r.title,"onUpdate:modelValue":a[0]||(a[0]=e=>r.title=e),onInput:E},null,8,["is-error","modelValue"])]),"error-text":p(()=>{var e,t;return[B(z(s(y).validationMessages[(t=(e=w.value)==null?void 0:e.at(0))==null?void 0:t.$validator]),1)]}),_:1},8,["is-error"])]),u(s($),{state:o.value},null,8,["state"]),u(s(M),{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),type:"error"},null,8,["modelValue"])],64))}};export{J as default};
