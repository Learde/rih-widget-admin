import{u as D,B as E,a as R,b as $,r as x}from"./BaseInput-SKxtzVrf.js";import{V as P,a8 as T,P as k,g as q,W as L,S as h,B as V,m as g,l as F,a7 as I,o as M,c as O,a as _,b as n,w as c,u as r,F as U,f as B,y as C}from"./index-CtEuYAy1.js";import{B as G}from"./BaseFormGroup-CQZnYBTp.js";const H={__name:"PointEditPage",props:{id:{type:[String,Number],default:null}},setup(y){const o=y,N=P(),m=T(),i=k(),w=q(),p=L(),t=h({title:""}),u=V(!1),l=D({formData:{title:{required:x}}},{formData:t}),v=g(()=>!l.value.formData.title.$error),S=g(()=>l.value.formData.title.$errors),b=function(){l.value.formData.title.$touch()},s=V("pending");return F(async()=>{if(o.id){s.value="loading";const d=await i.getOne(o.id);s.value="pending",t.title=d.title}m.addEventListener("ready",async()=>{if(!await l.value.$validate()){u.value=!0;return}s.value="loading",o.id?await i.editOne(o.id,{id:o.id,title:t.title}):await i.addOne({title:t.title}),s.value="success",setTimeout(()=>{const e={};p.query.backRouteName&&(e.noReset=!0),w.push({name:p.query.backRouteName||"Points",query:e})},1500)})}),I(()=>{m.clearEventListeners("ready")}),(d,e)=>(M(),O(U,null,[_("div",null,[n(r(G),{"is-error":!v.value},{label:c(()=>[B(" Название пункта проката * ")]),content:c(()=>[n(r(E),{placeholder:"Введите название","is-error":!v.value,modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=a=>t.title=a),onInput:b},null,8,["is-error","modelValue"])]),"error-text":c(()=>{var a,f;return[B(C(r(N).validationMessages[(f=(a=S.value)==null?void 0:a.at(0))==null?void 0:f.$validator]),1)]}),_:1},8,["is-error"])]),n(r(R),{state:s.value},null,8,["state"]),n(r($),{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),type:"error"},null,8,["modelValue"])],64))}};export{H as default};
