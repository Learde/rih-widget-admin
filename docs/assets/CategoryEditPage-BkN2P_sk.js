import{u as b,B as x,a as $,b as L,r as M}from"./BaseInput-SKxtzVrf.js";import{V as T,a8 as C,M as F,g as I,S as _,B as n,m as V,l as k,a7 as q,o as P,c as R,a as U,b as u,w as p,u as s,F as G,L as O,f as B,y as j}from"./index-CtEuYAy1.js";import{B as z}from"./BaseFormGroup-CQZnYBTp.js";const Q={__name:"CategoryEditPage",props:{id:{type:[String,Number],required:!0}},setup(h){const y=h,N=T(),m=C(),f=F(),w=I(),r=_({title:""}),i=n(!1),l=b({formData:{title:{required:M}}},{formData:r}),g=V(()=>!l.value.formData.title.$error),D=V(()=>l.value.formData.title.$errors),E=function(){l.value.formData.title.$touch()},o=n("pending"),d=n([]),c=n(null),S=function(v){var e;const a=O.clone(d.value);for(;a.length>0;){const t=a.pop();if(Number(t.id)===Number(v))return t;((e=t==null?void 0:t.children)==null?void 0:e.length)>0&&a.push(...t.children)}};return k(async()=>{o.value="loading",d.value=await f.fetchMany({page:1,perPage:999}),c.value=S(y.id),r.title=c.value.title,o.value="pending",m.addEventListener("ready",async()=>{if(!await l.value.$validate()){i.value=!0;return}o.value="loading",c.value.title=r.title,await f.editOne(null,d.value),o.value="success",setTimeout(()=>{w.push({name:"Categories"})},1500)})}),q(()=>{m.clearEventListeners("ready")}),(v,a)=>(P(),R(G,null,[U("div",null,[u(s(z),{"is-error":!g.value},{label:p(()=>[B(" Название категории * ")]),content:p(()=>[u(s(x),{placeholder:"Введите название","is-error":!g.value,modelValue:r.title,"onUpdate:modelValue":a[0]||(a[0]=e=>r.title=e),onInput:E},null,8,["is-error","modelValue"])]),"error-text":p(()=>{var e,t;return[B(j(s(N).validationMessages[(t=(e=D.value)==null?void 0:e.at(0))==null?void 0:t.$validator]),1)]}),_:1},8,["is-error"])]),u(s($),{state:o.value},null,8,["state"]),u(s(L),{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),type:"error"},null,8,["modelValue"])],64))}};export{Q as default};
