import{u as O,B as q,r as x,a as z}from"./BaseInput-9pf6eSRP.js";import{_ as S,o as E,c as P,a as r,a2 as H,N as C,b as n,w as u,d as v,u as t,t as M,l as A,p as N,e as R,Z as G,H as Q,z as Y,M as Z,q as k,D as F,f as L,j as J,Y as K,F as D,k as W,a3 as X}from"./index-fKPgX005.js";import{I as ee}from"./IconDelete-zZdqq761.js";import{B as w}from"./BaseSquareInput-r2u2iiwA.js";import{B as j}from"./BaseFormGroup-57tQ-1P9.js";const te={name:"Fa6RegularCircleQuestion"},oe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 512 512"},se=r("path",{fill:"currentColor",d:"M464 256a208 208 0 1 0-416 0a208 208 0 1 0 416 0M0 256a256 256 0 1 1 512 0a256 256 0 1 1-512 0m169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0a32 32 0 1 1-64 0"},null,-1),re=[se];function ne(a,_,T,g,i,f){return E(),P("svg",oe,re)}const ae=S(te,[["render",ne]]),ie=a=>(N("data-v-3fd9dd00"),a=a(),R(),a),le={class:"price-value"},de={class:"input-period-wrapper"},ue={class:"input-period"},pe={class:"error-text"},ce={class:"more-then"},me={class:"more-then-title"},ve=ie(()=>r("span",{class:"more-then-text"},"Расценка активна, начиная с ",-1)),_e={class:"more-then-period"},he={class:"input-price"},fe={class:"input-price-wrapper"},$e={__name:"InventoryPriceValueEditor",props:{period:{type:Object,required:!0},moreThen:{type:Object,required:!0},price:{type:Number,required:!0}},emits:["update:period","update:moreThen","update:price","delete"],setup(a,{emit:_}){const T=a,g=_,{period:i,moreThen:f,price:l}=H(T,g),y=C(),U=O({period:{days:{required:x},hours:{required:x},minutes:{required:x}},price:{required:x}},{period:i,price:l}),b=function(d){let e=U.value;return d.forEach(p=>{e=e[p]}),e},I=function(...d){return!b(d).$error},$=function(...d){return b(d).$errors},V=function(...d){b(d).$touch()};return(d,e)=>{var p,c;return E(),P("div",le,[r("div",de,[r("div",ue,[n(t(w),{min:"0",modelValue:t(i).days,"onUpdate:modelValue":e[0]||(e[0]=o=>t(i).days=o),"is-error":!I("period","days"),onInput:e[1]||(e[1]=o=>V("period","days"))},{label:u(()=>[v(" Дней * ")]),_:1},8,["modelValue","is-error"]),n(t(w),{min:"0",modelValue:t(i).hours,"onUpdate:modelValue":e[2]||(e[2]=o=>t(i).hours=o),"is-error":!I("period","hours"),onInput:e[3]||(e[3]=o=>V("period","hours"))},{label:u(()=>[v(" Часов * ")]),_:1},8,["modelValue","is-error"]),n(t(w),{min:"0",modelValue:t(i).minutes,"onUpdate:modelValue":e[4]||(e[4]=o=>t(i).minutes=o),"is-error":!I("period","minutes"),onInput:e[5]||(e[5]=o=>V("period","minutes"))},{label:u(()=>[v(" Минут * ")]),_:1},8,["modelValue","is-error"])]),r("span",pe,M(t(y).validationMessages[(c=(p=$("period"))==null?void 0:p.at(0))==null?void 0:c.$validator]),1)]),r("div",ce,[r("div",me,[ve,n(t(ae),{class:"more-then-icon"})]),r("div",_e,[n(t(w),{min:"0",modelValue:t(f).days,"onUpdate:modelValue":e[6]||(e[6]=o=>t(f).days=o)},{label:u(()=>[v(" Дней ")]),_:1},8,["modelValue"]),n(t(w),{min:"0",modelValue:t(f).hours,"onUpdate:modelValue":e[7]||(e[7]=o=>t(f).hours=o)},{label:u(()=>[v(" Часов ")]),_:1},8,["modelValue"])])]),r("div",he,[n(t(j),{"is-error":!I("price")},{label:u(()=>[v(" Цена * ")]),content:u(()=>[r("div",fe,[n(t(q),{class:"input-price-input",placeholder:"Введите цену",onInput:e[8]||(e[8]=o=>V("price")),"is-error":!I("price"),modelValue:t(l),"onUpdate:modelValue":e[9]||(e[9]=o=>A(l)?l.value=o:null)},null,8,["is-error","modelValue"]),n(t(ee),{class:"price-value-delete",onClick:e[10]||(e[10]=o=>d.$emit("delete"))})])]),"error-text":u(()=>{var o,s;return[v(M(t(y).validationMessages[(s=(o=$("price"))==null?void 0:o.at(0))==null?void 0:s.$validator]),1)]}),_:1},8,["is-error"])])])}}},Ve=S($e,[["__scopeId","data-v-3fd9dd00"]]),B=a=>(N("data-v-b8e9734a"),a=a(),R(),a),ye=B(()=>r("hr",null,null,-1)),Ie=B(()=>r("h3",null,"Расценки",-1)),ge=B(()=>r("hr",null,null,-1)),be={class:"add-value-icon"},we=B(()=>r("span",{class:"add-value-text"},"Добавить расценку",-1)),xe={__name:"InventoryPriceEditPage",props:{id:{type:[String,Number],default:null}},setup(a){const _=a,T=C(),g=G(),i=Q(),f=Y(),l=Z({title:""}),y={key:0,period:{days:0,hours:0,minutes:0},moreThen:{days:0,hours:0},price:0},h=k([F.cloneDeep(y)]),U=function(){y.key++,h.value.push(F.cloneDeep(y))},b=function(c){h.value.splice(h.value.indexOf(c),1)},$=O({formData:{title:{required:x}}},{formData:l}),V=L(()=>!$.value.formData.title.$error),d=L(()=>$.value.formData.title.$errors),e=function(){$.value.formData.title.$touch()},p=k("pending");return J(async()=>{if(_.id){p.value="loading";const c=await i.getOne(_.id);p.value="pending",l.title=c.title,h.value=c.values}g.addEventListener("ready",async()=>{await $.value.$validate()&&(p.value="loading",_.id?await i.editOne(_.id,{id:_.id,title:l.title,values:h.value}):await i.addOne({title:l.title,values:h.value}),p.value="success",setTimeout(()=>{f.push({name:"InventoryPrices"})},1500))})}),K(()=>{g.clearEventListeners("ready")}),(c,o)=>(E(),P(D,null,[r("div",null,[n(t(j),{"is-error":!V.value},{label:u(()=>[v(" Название тарифа * ")]),content:u(()=>[n(t(q),{placeholder:"Введите название","is-error":!V.value,modelValue:l.title,"onUpdate:modelValue":o[0]||(o[0]=s=>l.title=s),onInput:e},null,8,["is-error","modelValue"])]),"error-text":u(()=>{var s,m;return[v(M(t(T).validationMessages[(m=(s=d.value)==null?void 0:s.at(0))==null?void 0:m.$validator]),1)]}),_:1},8,["is-error"]),ye,Ie,(E(!0),P(D,null,W(h.value,s=>(E(),P(D,{key:s.id??s.key},[n(t(Ve),{period:s.period,"onUpdate:period":m=>s.period=m,"more-then":s.moreThen,"onUpdate:moreThen":m=>s.moreThen=m,price:s.price,"onUpdate:price":m=>s.price=m,onDelete:m=>b(s)},null,8,["period","onUpdate:period","more-then","onUpdate:moreThen","price","onUpdate:price","onDelete"]),ge],64))),128)),r("button",{class:"add-value-btn",onClick:U},[r("span",be,[n(t(X))]),we])]),n(t(z),{state:p.value},null,8,["state"])],64))}},De=S(xe,[["__scopeId","data-v-b8e9734a"]]);export{De as default};
