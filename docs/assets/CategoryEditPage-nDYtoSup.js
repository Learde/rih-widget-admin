import{u as x,B as $,a as b,r as M}from"./BaseInput-9pf6eSRP.js";import{N as S,Z as T,G as _,z as C,M as L,f as g,q as d,j as q,Y as F,o as I,c as k,a as G,b as c,w as p,u as n,F as P,D as R,d as h,t as j}from"./index-fKPgX005.js";import{B as z}from"./BaseFormGroup-57tQ-1P9.js";const A={__name:"CategoryEditPage",props:{id:{type:[String,Number],required:!0}},setup(B){const V=B,N=S(),v=T(),m=_(),y=C(),r=L({title:""}),o=x({formData:{title:{required:M}}},{formData:r}),f=g(()=>!o.value.formData.title.$error),D=g(()=>o.value.formData.title.$errors),E=function(){o.value.formData.title.$touch()},s=d("pending"),l=d([]),i=d(null),w=function(u){var t;const a=R.clone(l.value);for(;a.length>0;){const e=a.pop();if(Number(e.id)===Number(u))return e;((t=e==null?void 0:e.children)==null?void 0:t.length)>0&&a.push(...e.children)}};return q(async()=>{s.value="loading",l.value=await m.fetchMany({page:1,perPage:999}),i.value=w(V.id),r.title=i.value.title,s.value="pending",v.addEventListener("ready",async()=>{await o.value.$validate()&&(s.value="loading",i.value.title=r.title,await m.editOne(null,l.value),s.value="success",setTimeout(()=>{y.push({name:"Categories"})},1500))})}),F(()=>{v.clearEventListeners("ready")}),(u,a)=>(I(),k(P,null,[G("div",null,[c(n(z),{"is-error":!f.value},{label:p(()=>[h(" Название категории * ")]),content:p(()=>[c(n($),{placeholder:"Введите название","is-error":!f.value,modelValue:r.title,"onUpdate:modelValue":a[0]||(a[0]=t=>r.title=t),onInput:E},null,8,["is-error","modelValue"])]),"error-text":p(()=>{var t,e;return[h(j(n(N).validationMessages[(e=(t=D.value)==null?void 0:t.at(0))==null?void 0:e.$validator]),1)]}),_:1},8,["is-error"])]),c(n(b),{state:s.value},null,8,["state"])],64))}};export{A as default};
