import{u as b,B as S,a as T,b as $,r as L}from"./BaseInput-vHVzaQb9.js";import{T as C,a4 as M,L as k,g as q,P as F,A as n,k as V,q as I,a3 as P,o as _,c as R,a as U,b as u,w as p,u as s,F as A,K as G,f as B,x as K}from"./index-436tC9rP.js";import{B as O}from"./BaseFormGroup-stphhqJr.js";const Q={__name:"CategoryEditPage",props:{id:{type:[String,Number],required:!0}},setup(h){const N=h,y=C(),m=M(),f=k(),w=q(),r=F({title:""}),i=n(!1),l=b({formData:{title:{required:L}}},{formData:r}),g=V(()=>!l.value.formData.title.$error),x=V(()=>l.value.formData.title.$errors),D=function(){l.value.formData.title.$touch()},o=n("pending"),d=n([]),c=n(null),E=function(v){var e;const a=G.clone(d.value);for(;a.length>0;){const t=a.pop();if(Number(t.id)===Number(v))return t;((e=t==null?void 0:t.children)==null?void 0:e.length)>0&&a.push(...t.children)}};return I(async()=>{o.value="loading",d.value=await f.fetchMany({page:1,perPage:999}),c.value=E(N.id),r.title=c.value.title,o.value="pending",m.addEventListener("ready",async()=>{if(!await l.value.$validate()){i.value=!0;return}o.value="loading",c.value.title=r.title,await f.editOne(null,d.value),o.value="success",setTimeout(()=>{w.push({name:"Categories"})},1500)})}),P(()=>{m.clearEventListeners("ready")}),(v,a)=>(_(),R(A,null,[U("div",null,[u(s(O),{"is-error":!g.value},{label:p(()=>[B(" Название категории * ")]),content:p(()=>[u(s(S),{placeholder:"Введите название","is-error":!g.value,modelValue:r.title,"onUpdate:modelValue":a[0]||(a[0]=e=>r.title=e),onInput:D},null,8,["is-error","modelValue"])]),"error-text":p(()=>{var e,t;return[B(K(s(y).validationMessages[(t=(e=x.value)==null?void 0:e.at(0))==null?void 0:t.$validator]),1)]}),_:1},8,["is-error"])]),u(s(T),{state:o.value},null,8,["state"]),u(s($),{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),type:"error"},null,8,["modelValue"])],64))}};export{Q as default};
